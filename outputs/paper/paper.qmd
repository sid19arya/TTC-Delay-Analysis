---
title: "Have public transport delays in toronto gotten worse over time? An Analysis of the TTC Street Car Delays"
# subtitle: "My subtitle if needed"
author: 
  - Siddharth Arya
thanks: "Code and data are available at: https://github.com/sid19arya/TTC-Delay-Analysis.git"
date: today
date-format: long
abstract: "The TTC (Toronto Transit Commission) has been a core part of all residents of the city for decades - keeping each part of the city connected. That being said, the TTC is under constant scrutiny and criticism, especially in recent years regarding delays worsening - inconveniencing people's commutes. This paper examines the TTC Delays, using data from OpenDataToronto, and disproves the notion that delays have been getting increasingly worse over the past few years."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(knitr)
library(kableExtra)
analysis_data <- read_csv(here("outputs/data/analysis_data.csv"))
analysis_data$Date <- factor(analysis_data$Date, levels = unique(analysis_data$Date))
raw_data_ex <- read_csv(here("inputs/data/raw_data_2021.csv"))

```











# Introduction

As the COVID-19 pandemic died down, riders returned to the TTC, making the public transit around the city active once more. However, with their return came rampant criticism about the delays regarding the TTC. Pseudo-studies claim confidently that the TTC is deteriorating as time passes (sources) and adding to the commutes of residents of the city. 

However, these are empty claims yet to be strongly supported or disproved. This study looks more closely at TTC data - specifically at streetcar delays, to reveal wether these claims are truly founded or not.

This paper is organized in the following sections: Data, Results, Conclusion… 


# Data {#sec-data}

The data utilized in this paper is from OpenDataToronto Library, the Datasets used are entitled: “TTC-Streetcar-Delays”. The data was collected, sorted and analyzed through the help of … (Cite all the packages).


The data in its raw form includes all these values (table 1)

```{r}
#| echo: false
table_raw <- kable(head(raw_data_ex)) %>% 
  kable_styling(full_width = FALSE) %>% 
  kable_styling(
      latex_options = c("hold_position"),
      full_width = FALSE
    ) %>%
    column_spec(column = 1:ncol(raw_data_ex), width = "2cm")

table_raw2 <- kable(head(raw_data_ex),
  escape = FALSE) %>%
  kable_styling(
    full_width = FALSE,  # Set to FALSE to limit width
    bootstrap_options = "striped",  # Add striped rows for better readability
    latex_options = c("hold_position")  # Use LaTeX options
  ) %>%
  row_spec(0, bold = TRUE)  # Bold the header row


table_raw2
```

We clean the data, and join the data sets for all 3 years to get a table that looks like this (table 2)
Important part to note is we grouped over all the incidents for a particular month and aggregated to get the incidents and total_delay values. 


```{r}
#| echo: false
table <- kable(head(analysis_data)) %>% 
  kable_styling(full_width = FALSE)

table 
```

From this we can create visualizations that are able to clearly indicate the change in number of incidents and total delay time over the months of 2021, 2022, 20223, as seen in graph 1 and 2 respectively. 


```{r fig.width=8}
#| echo: false


ggplot(analysis_data, aes(Date, incidents)) +
  geom_col()+
  coord_flip()
```

```{r fig.width=8}
#| echo: false

ggplot(analysis_data, aes(Date, total_delay)) +
  geom_col() +
  coord_flip() + 
  scale_x_discrete(limits = rev(levels(analysis_data$Date)))
```

```{r}
ggplot(analysis_data, aes(x = months_elapsed, y = incidents)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") # Add a line of best fit
```



```{r}
ggplot(analysis_data, aes(x = months_elapsed, y = total_delay)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") # Add a line of best fit

```
```{r}
incidents_correlation <- cor(analysis_data$months_elapsed, analysis_data$incidents)
delay_correlation <- cor(analysis_data$months_elapsed, analysis_data$total_delay)
print(paste("Incidents_Correlation (R value):", incidents_correlation))
print(paste("Delay_Correlation (R value):", delay_correlation))

```


# Results

Clearly, there is no such trend, there is no evidence that the delays have been getting worse for the past 2 years. 


# Discussion


# Conclusion

This paper investigated TTC delays spanning the years 2021, 2022, 2023 to see if a trend over time could be spotted. The paper concluded that there was no noticeable 





\newpage




# References

::: {#refs}
:::


